<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CourtEase - Your Bookings</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    .navbar-nav { gap: 1rem; }
    .nav-link-btn { padding: .5rem 1rem !important; color: inherit !important; }
    .nav-link-btn:hover, .nav-link-btn:focus { text-decoration: none !important; }
    .nav-link-btn.text-warning { color: #ffc107 !important; }
    .nav-link-btn.text-warning:hover,
    .nav-link-btn.text-warning:focus { color: #ffca2c !important; }
  </style>
</head>
<body class="bg-light">

<div class="toast-container position-fixed top-0 end-0 p-3">
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="toast text-bg-{{ category }} border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="2000">
          <div class="d-flex">
            <div class="toast-body">{{ message }}</div>
            <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast"></button>
          </div>
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}
</div>

<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
  <div class="container-fluid">
    <a class="navbar-brand fw-bold d-flex align-items-center" href="{{ url_for('calendar.tournament_calendar') }}">
      <img src="{{ url_for('static', filename='tennis-court.png') }}" style="height:30px;" class="me-2" alt="">
      CourtEase üèüÔ∏è
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav"
            aria-controls="mainNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="mainNav">
      <ul class="navbar-nav mx-auto mb-2 mb-lg-0 align-items-lg-center">
        <li class="nav-item">
          <a class="nav-link" href="{{ url_for('calendar.tournament_calendar') }}">Tournament Calendar</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" href="{{ url_for('booking.manage_bookings') }}">Your Bookings</a>
        </li>
        <li class="nav-item">
          <form action="{{ url_for('auth.logout') }}" method="POST" class="d-inline">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit" class="btn btn-link nav-link-btn text-warning p-0">Logout</button>
          </form>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="container my-4">
  <div class="d-flex justify-content-between align-items-center">
    <h2>Your Bookings</h2>
    <div>
      <a href="{{ url_for('booking.book') }}" class="btn btn-warning">‚ûï Add New Booking</a>
      <a href="{{ url_for('calendar.tournament_calendar') }}" class="btn btn-secondary ms-2">‚¨Ö Back to Calendar</a>
    </div>
  </div>

  {% if bookings %}
    <div class="table-responsive mt-3">
      <table class="table table-bordered table-hover text-center align-middle">
        <thead class="table-dark">
          <tr>
            <th>Court</th>
            <th>Date</th>
            <th>Start Time</th>
            <th>End Time</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for b in bookings %}
            <tr>
              <td>{{ b.court_name }}</td>
              <td>{{ b.booking_date }}</td>
              <td>{{ b.start_time }}</td>
              <td>{{ b.end_time }}</td>
              <td>
                <a href="{{ url_for('booking.edit_booking', booking_id=b.id) }}" class="btn btn-sm btn-warning">Edit</a>
                <form action="{{ url_for('booking.cancel_booking', booking_id=b.id) }}" method="POST" class="d-inline">
                  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                  <button type="submit" class="btn btn-sm btn-danger">Cancel</button>
                </form>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <div class="alert alert-info mt-4">
      You don‚Äôt have any bookings yet.
      <a href="{{ url_for('booking.book') }}" class="btn btn-sm btn-primary ms-2">Book Now</a>
      <a href="{{ url_for('calendar.tournament_calendar') }}" class="btn btn-sm btn-secondary ms-2">Back to Calendar</a>
    </div>
  {% endif %}
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function(){
    document.querySelectorAll('.toast').forEach(el => new bootstrap.Toast(el).show());
  });
</script>
</body>
</html>